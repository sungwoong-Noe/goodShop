<!DOCTYPE html>
<html lang="en" th:replace="layouts/layout :: layoutFragment(~{::main})" xmlns:th="https://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<main>
    <div class="page-section mt-5 " style="border: 1px solid #e9e8f5;">
        <div class="container">
            <div class="text-left wow fadeInUp ">
                <ul style="list-style: none;" class="pl-0">
                    <li style="float:left;">
                        <img src="/img/brand/PeaceworkerLogo.jpg" width="74" alt="">
                    </li>
                    <li>
                        <div class="ml-5 pl-5">
                            <h2 class="title-section"><a href="" style="color: black;">Peace Worker</a></h2>
                            <div>피스워커</div>
                        </div>
                    </li>
                </ul>

            </div>

            <div class="row mt-5 text-center">
                <div class="col-lg-6 py-3 wow fadeInUp">
                    <div class="display-3">
                        <img th:src="|/images/${product.getPdct_image()}|"  width="540" alt="">
                    </div>
                </div>
                <div class="col-lg-6 py-3 text-left">
                    <form th:href="@{/order}" method="post" name="pdct_form">
                            <div th:if="${session.loginUser != null}">
                                <input type="hidden" th:value="${product.getPdct_code()}" name="pdct_code">
                                <input type="hidden"  th:value="${session.loginUser.getUser_id()}"></input>
                            </div>

                            <div class="features pt-4 pb-2">
                                <b th:text="${product.getPdct_name()}">상품이름</b>
                                <h5 class="pt-5" th:text="${product.getPdct_price()} + 원"> 상품가격</h5>
                            </div>
                            <h5 class="pt-3 mb-3" style="font-size: 15px;">배송정보</h5>
                            <ul style="list-style: none;" class="pl-0">
                                <li style="float:left;">
                                    <div style="width: 100px;">배송비</div>
                                </li>
                                <li>
                                    <div style="font-size: 10px;">
                                        <div>해당 브랜드의 제품은 무료배송됩니다.</div>
                                        <div>제주도를 포함한 도서/산간지역은 추개 배송비 3,000원</div>
                                    </div>
                                </li>
                            </ul>
                            <div class="mb-5">
                                <button type ="button" onclick="count('plus');">+</button>
                                <input type="text" id="pdct_quantity" name="pdct_quantity" th:value="1" readonly="readonly" style="text-align:center;"/>
                                <button type="button" onclick="count('minus');">-</button>
                            </div>
                            <button class="btn btn-primary">장바구니</button>
                            <button class="btn btn-outline" th:onclick="buyButton(${session.loginUser.getUser_id()})">구매하기</button>
                            <a th:if="${session.loginUser.getUser_name() == product.getSeller()}" th:href="@{/item/} + ${product.getPdct_code} + @{/edit}"> 수정</a>

                        </form>
                    </div>
                </div>
            </div>
        </div> <!-- .container -->
        <div class="container">
            <div class="page-section">
                <div class="row">
                    <div class="col-lg-6">
                        상품설명
                        <img th:src="|/images/${product.getDetail_image()}|"  alt="">
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- .page-section -->

</main>
</html>
<script>
    function count(type){
        const resultElement = document.getElementById('pdct_quantity');

        let number = resultElement.value;


        if(type === 'plus') {
            number = parseInt(number) + 1;
        }else if(type === 'minus'){
            if(number < 2){
                alert("1보다 작을수 없습니다.")
            }else{
                number = parseInt(number) - 1;
            }
        }

        resultElement.value = number;
    }

    function buyButton(loginUser){

        if(loginUser === null){
            alert("로그인 후 구매해주세요");
        }else if(loginUser === null){
            document.pdct_form.submit();
        }
    }

</script>